{"version":3,"file":"vue.cjs.js","sources":["../src/index.ts"],"sourcesContent":["// This entry is the \"full-build\" that includes both the runtime\r\n// and the compiler, and supports on-the-fly compilation of the template option.\r\nimport { initDev } from './dev'\r\nimport {\r\n  type CompilerError,\r\n  type CompilerOptions,\r\n  compile,\r\n} from '@vue/compiler-dom'\r\nimport {\r\n  type RenderFunction,\r\n  registerRuntimeCompiler,\r\n  warn,\r\n} from '@vue/runtime-dom'\r\nimport * as runtimeDom from '@vue/runtime-dom'\r\nimport {\r\n  EMPTY_OBJ,\r\n  NOOP,\r\n  extend,\r\n  generateCodeFrame,\r\n  isString,\r\n} from '@vue/shared'\r\nimport type { InternalRenderFunction } from 'packages/runtime-core/src/component'\r\n\r\nif (__DEV__) {\r\n  initDev()\r\n}\r\n\r\nconst compileCache = new WeakMap<\r\n  CompilerOptions,\r\n  Record<string, RenderFunction>\r\n>()\r\n\r\nfunction getCache(options?: CompilerOptions) {\r\n  let c = compileCache.get(options ?? EMPTY_OBJ)\r\n  if (!c) {\r\n    c = Object.create(null) as Record<string, RenderFunction>\r\n    compileCache.set(options ?? EMPTY_OBJ, c)\r\n  }\r\n  return c\r\n}\r\n\r\nfunction compileToFunction(\r\n  template: string | HTMLElement,\r\n  options?: CompilerOptions,\r\n): RenderFunction {\r\n  if (!isString(template)) {\r\n    if (template.nodeType) {\r\n      template = template.innerHTML\r\n    } else {\r\n      __DEV__ && warn(`invalid template option: `, template)\r\n      return NOOP\r\n    }\r\n  }\r\n\r\n  const key = template\r\n  const cache = getCache(options)\r\n  const cached = cache[key]\r\n  if (cached) {\r\n    return cached\r\n  }\r\n\r\n  if (template[0] === '#') {\r\n    const el = document.querySelector(template)\r\n    if (__DEV__ && !el) {\r\n      warn(`Template element not found or is empty: ${template}`)\r\n    }\r\n    // __UNSAFE__\r\n    // Reason: potential execution of JS expressions in in-DOM template.\r\n    // The user must make sure the in-DOM template is trusted. If it's rendered\r\n    // by the server, the template should not contain any user data.\r\n    template = el ? el.innerHTML : ``\r\n  }\r\n\r\n  const opts = extend(\r\n    {\r\n      hoistStatic: true,\r\n      onError: __DEV__ ? onError : undefined,\r\n      onWarn: __DEV__ ? e => onError(e, true) : NOOP,\r\n    } as CompilerOptions,\r\n    options,\r\n  )\r\n\r\n  if (!opts.isCustomElement && typeof customElements !== 'undefined') {\r\n    opts.isCustomElement = tag => !!customElements.get(tag)\r\n  }\r\n\r\n  const { code } = compile(template, opts)\r\n\r\n  function onError(err: CompilerError, asWarning = false) {\r\n    const message = asWarning\r\n      ? err.message\r\n      : `Template compilation error: ${err.message}`\r\n    const codeFrame =\r\n      err.loc &&\r\n      generateCodeFrame(\r\n        template as string,\r\n        err.loc.start.offset,\r\n        err.loc.end.offset,\r\n      )\r\n    warn(codeFrame ? `${message}\\n${codeFrame}` : message)\r\n  }\r\n\r\n  // The wildcard import results in a huge object with every export\r\n  // with keys that cannot be mangled, and can be quite heavy size-wise.\r\n  // In the global build we know `Vue` is available globally so we can avoid\r\n  // the wildcard object.\r\n  const render = (\r\n    __GLOBAL__ ? new Function(code)() : new Function('Vue', code)(runtimeDom)\r\n  ) as RenderFunction\r\n\r\n  // mark the function as runtime compiled\r\n  ;(render as InternalRenderFunction)._rc = true\r\n\r\n  return (cache[key] = render)\r\n}\r\n\r\nregisterRuntimeCompiler(compileToFunction)\r\n\r\nexport { compileToFunction as compile }\r\nexport * from '@vue/runtime-dom'\r\n"],"names":["EMPTY_OBJ","isString","warn","NOOP","extend","compile","generateCodeFrame","runtimeDom","registerRuntimeCompiler"],"mappings":"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"}